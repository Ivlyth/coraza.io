<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=https://coraza.io/main.2c9f70dcb4fa7338a2710d7e8082480428e46a25e15ab2f37cb3f71ec47d2c5b135b9719a2944042c9fbe98c76827679d31e5a9bfe2f797a2ab4b669e49151b5.css integrity="sha512-LJ9w3LT6cziicQ1+gIJIBCjkaiXhWrLzfLP3HsR9LFsTW5cZopRAQsn76Yx2gnZ50x5am/4veXoqtLZp5JFRtQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Extending - Coraza WAF</title><meta name=description content="Easily extend Coraza with your own Operators, Actions, Audit Loggers and Persistence engines."><link rel=canonical href=https://coraza.io/docs/reference/extending/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Extending"><meta property="og:description" content="Easily extend Coraza with your own Operators, Actions, Audit Loggers and Persistence engines."><meta property="og:url" content="https://coraza.io/docs/reference/extending/"><meta property="og:site_name" content="Coraza WAF"><meta property="article:published_time" content="2020-10-06T08:48:57+00:00"><meta property="article:modified_time" content="2020-10-06T08:48:57+00:00"><meta property="og:image" content="https://coraza.io/doks.png"><meta property="og:image:alt" content="Coraza WAF"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@corazatech"><meta name=twitter:creator content="@jptosso"><meta name=twitter:title content="Extending"><meta name=twitter:description content="Easily extend Coraza with your own Operators, Actions, Audit Loggers and Persistence engines."><meta name=twitter:image content="https://coraza.io/doks.png"><meta name=twitter:image:alt content="Extending"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/1","name":"Coraza WAF","url":"https://coraza.io/","sameAs":["https://twitter.com/corazatech","https://github.com/jptosso/coraza-waf"],"image":{"@type":"ImageObject","@id":"https://coraza.io/#/schema/image/1","url":"https://coraza.io/doks.png","width":1280,"height":640,"caption":"Coraza WAF"}},{"@type":"WebSite","@id":"https://coraza.io/#/schema/website/1","url":"https://coraza.io/","name":"Coraza WAF","description":"Coraza is an enterprise-grade, open source and high performance Web Application Firewall ready to easily protect your beloved applications.","publisher":{"@id":"https://coraza.io/#/schema/person/1"}},{"@type":"WebPage","@id":"https://coraza.io/docs/reference/extending/","url":"https://coraza.io/docs/reference/extending/","name":"Extending","description":"Easily extend Coraza with your own Operators, Actions, Audit Loggers and Persistence engines.","isPartOf":{"@id":"https://coraza.io/#/schema/website/1"},"about":{"@id":"https://coraza.io/#/schema/person/1"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","breadcrumb":{"@id":"https://coraza.io/docs/reference/extending/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://coraza.io/docs/reference/extending/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://coraza.io/docs/reference/extending/"]}]},{"@type":"BreadcrumbList","@id":"https://coraza.io/docs/reference/extending/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://coraza.io/","url":"https://coraza.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/","url":"https://coraza.io/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/reference/","url":"https://coraza.io/docs/reference/","name":"Reference"}},{"@type":"ListItem","position":4,"item":{"@id":"https://coraza.io/docs/reference/extending/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://coraza.io/#/schema/article/1","headline":"Extending","description":"Easily extend Coraza with your own Operators, Actions, Audit Loggers and Persistence engines.","isPartOf":{"@id":"https://coraza.io/docs/reference/extending/"},"mainEntityOfPage":{"@id":"https://coraza.io/docs/reference/extending/"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","author":{"@id":"https://coraza.io/#/schema/person/2"},"publisher":{"@id":"https://coraza.io/#/schema/person/1"},"image":{"@id":"https://coraza.io/docs/reference/extending/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/2","name":"Juan Pablo Tosso","sameAs":["https://twitter.com/jptosso","https://www.linkedin.com/in/jptosso/","https://github.com/jptosso"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://coraza.io/docs/reference/extending/#/schema/image/2","url":"https://coraza.io/doks.png","contentUrl":"https://coraza.io/doks.png","caption":"Extending"}]}]}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-1J0TK2GV0R"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-1J0TK2GV0R')</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://coraza.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://coraza.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://coraza.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://coraza.io/site.webmanifest></head><body class="docs single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label>
<a class="navbar-brand order-1 order-md-0 me-auto" href=https://coraza.io/>Coraza WAF</a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://twitter.com/jptosso><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><span class="ms-2 visually-hidden">Twitter</span></a></li><li class=nav-item><a class=nav-link href=https://github.com/jptosso/coraza-waf><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ms-2 visually-hidden">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav me-auto order-5 order-md-2"><li class="nav-item active"><a class=nav-link href=https://coraza.io/docs/tutorials/introduction/>Docs</a></li><li class=nav-item><a class=nav-link href=https://coraza.io/blog/>Blog</a></li><li class=nav-item><a class=nav-link href=https://coraza.io/plugins>Plugins</a></li><li class=nav-item><a class=nav-link href=https://playground.coraza.io/>Playground</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/virtualpatching/>Virtual Patching</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/dependencies/>Installing libinjection & libpcre</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/devsecops/>Continuous Delivery</a></li></ul><h3>Integrations</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/integrations/usecases/>Use Cases</a></li><li><a class=docs-link href=https://coraza.io/docs/integrations/docker/>Docker</a></li><li><a class=docs-link href=https://coraza.io/docs/integrations/kubernetes/>Kubernetes Ingress</a></li><li><a class=docs-link href=https://coraza.io/docs/integrations/traefik/>Traefik</a></li><li><a class=docs-link href=https://coraza.io/docs/integrations/caddy/>Caddy Server</a></li><li><a class=docs-link href=https://coraza.io/docs/integrations/gin/>Gin</a></li></ul><h3>Seclang</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3>Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/logging/>Logging</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/roadmap/>Roadmap</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class="docs-link active" href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#installing-a-plugin>Installing a plugin</a></li><li><a href=#creating-rule-actions>Creating Rule Actions</a><ul><li><a href=#rule-action-interface>Rule Action interface</a></li><li><a href=#action-types>Action types</a></li><li><a href=#creating-a-custom-action>Creating a custom action</a></li><li><a href=#transforming-the-action-to-plugin>Transforming the action to plugin</a></li></ul></li><li><a href=#creating-rule-transformations>Creating Rule Transformations</a><ul><li><a href=#transformation-type>Transformation Type</a></li><li><a href=#example>Example</a></li></ul></li><li><a href=#creating-rule-operators>Creating Rule Operators</a><ul><li><a href=#rule-operator-interface>Rule Operator interface</a></li><li><a href=#creating-a-custom-operator>Creating a custom operator</a></li><li><a href=#transforming-the-operator-to-plugin>Transforming the operator to plugin</a></li></ul></li><li><a href=#testing-your-plugin>Testing your plugin</a></li><li><a href=#adding-plugins-to-coraza-plugin-repository>Adding plugins to Coraza Plugin Repository</a><ul><li><a href=#requirements>Requirements</a></li><li><a href=#corazayml>.coraza.yml</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://coraza.io/>Home</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/>Docs</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/reference/>Reference</a></li><li class="breadcrumb-item active" aria-current=page>Extending</li></ol></nav><h1>Extending</h1><p class=lead>Plugins can be used to extend Coraza functionalities, right now, you can only extend Rule Actions, Rule Operators and Rule Transactions, but in the near future you may be able to add many additional functionalities.</p><ul><li><strong>Rule Operators:</strong> Create rule operators like @even to detect even numbers</li><li><strong>Rule Transformations:</strong> Create rule transformations like t:rot13 to encode your values in ROT13</li><li><strong>Rule Actions:</strong> Create rule actions like challenge to redirect a malicious request to some bot detection system</li></ul><p>The plugin interface provides three functions to extend rule operators, transformations and actions. Each one of them must match it&rsquo;s proper type or interface and be registered using the <code>plugins</code> package.</p><ul><li><strong>Operators</strong>: <code>type PluginOperatorWrapper() coraza.Operator</code></li><li><strong>Actions</strong>: <code>type PluginOperatorWrapper() coraza.RuleAction</code></li><li><strong>Transformations</strong>: <code>type Transformation = func(input string, tools *transformations.Tools) string</code></li></ul><p>After defining the plugins, we must register them using the <code>plugins.Register...</code> function inside the init function <code>func init(){}</code>.</p><ul><li><strong>Operators</strong>: <code>plugins.RegisterOperator(operator PluginOperatorWrapper)</code></li><li><strong>Actions</strong>: <code>plugins.RegisterAction(action PluginActionWrapper)</code></li><li><strong>Transformations</strong>: <code>plugins.RegisterTransformation(transformation transformations.Transformation)</code></li></ul><p><strong>Important:</strong> Some integrations like Traefik does not support plugins, because we cannot control how the integration is compiled by Pilot.</p><h2 id=installing-a-plugin>Installing a plugin<a href=#installing-a-plugin class=anchor aria-hidden=true>#</a></h2><p>Plugin model is based on Caddy plugins system, they must be compiled within the project just by importing them like this:</p><pre><code class=language-go>import(
    &quot;github.com/jptosso/coraza-waf&quot;
    _ &quot;github.com/someone/somecorazaplugin&quot;
)
</code></pre><h2 id=creating-rule-actions>Creating Rule Actions<a href=#creating-rule-actions class=anchor aria-hidden=true>#</a></h2><h3 id=rule-action-interface>Rule Action interface<a href=#rule-action-interface class=anchor aria-hidden=true>#</a></h3><pre><code class=language-go>type RuleAction interface {
	// Initializes an action, will be done during compilation
	Init(*Rule, string) error
	// Evaluate will be done during rule evaluation
	Evaluate(*Rule, *Transaction)
	// Type will return the rule type, it's used by Evaluate
	// to choose when to evaluate each action
	Type() int
}
</code></pre><h3 id=action-types>Action types<a href=#action-types class=anchor aria-hidden=true>#</a></h3><p>Each action can have one type that defines in which part of the rule lifetime it will be evaluated.</p><ul><li><strong>ACTION_TYPE_DISRUPTIVE</strong>: Cause Coraza to do something. In many cases something means block transaction, but not in all. For example, the allow action is classified as a disruptive action, but it does the opposite of blocking. There can only be one disruptive action per rule (if there are multiple disruptive actions present, or inherited, only the last one will take effect), or rule chain (in a chain, a disruptive action can only appear in the first rule).</li><li><strong>ACTION_TYPE_NONDISRUPTIVE</strong>: Do something, but that something does not and cannot affect the rule processing flow. Setting a variable, or changing its value is an example of a non-disruptive action. Non-disruptive action can appear in any rule, including each rule belonging to a chain.</li><li><strong>ACTION_TYPE_FLOW</strong>: These actions affect the rule flow (for example skip or skipAfter).</li><li><strong>ACTION_TYPE_METADATA</strong>: Meta-data actions are used to provide more information about rules. Examples include id, rev, severity and msg.</li><li><strong>ACTION_TYPE_DATA</strong>: - Not really actions, these are mere containers that hold data used by other actions. For example, the status action holds the status that will be used for blocking (if it takes place).</li></ul><h3 id=creating-a-custom-action>Creating a custom action<a href=#creating-a-custom-action class=anchor aria-hidden=true>#</a></h3><pre><code class=language-go>type id15 struct{}

// Initializes an action, will be done during compilation
func (id15) Init(rule *coraza.Rule, _ string) error {
	rule.Id = 15
	return nil
}

// Evaluate will be done during rule evaluation
func (id15) Evaluate(_ *coraza.Rule, _ *coraza.Transaction) {}

// ACTION_TYPE_DATA will be only evaluated while compiling the rule, Evaluate won't be called
func (id15) Type() int {
	return coraza.ACTION_TYPE_DATA
}

// Tripwire to match coraza.RuleAction type
var _ coraza.RuleAction = &amp;id15{}
</code></pre><h3 id=transforming-the-action-to-plugin>Transforming the action to plugin<a href=#transforming-the-action-to-plugin class=anchor aria-hidden=true>#</a></h3><p>Once the action is created, it must be wrapper inside a <code>type PluginActionWrapper = func() coraza.RuleAction</code> in order to be registered.</p><pre><code class=language-go>import(
    &quot;github.com/jptosso/coraza-waf&quot;
    &quot;github.com/jptosso/coraza-waf/plugins&quot;
)

func init() {
	plugins.RegisterAction(&quot;id15&quot;, func() coraza.RuleAction {
		return &amp;id15{}
	})
}
</code></pre><p>After properly importing the plugin, you may be able to create rules with <code>id15</code> action, for example:</p><pre><code>SecAction &quot;id15, nolog, pass&quot;
</code></pre><h2 id=creating-rule-transformations>Creating Rule Transformations<a href=#creating-rule-transformations class=anchor aria-hidden=true>#</a></h2><p>Transformations are the easiest components to extend, each transformation implements the <code>transformations.Transformation</code> type and can be registered directly using <code>plugins.RegisterTransformation(transformation transformations.Transformation)</code>.</p><p>The *Tools struct is designed to add additional functionalities like logging and unicode mapping.</p><h3 id=transformation-type>Transformation Type<a href=#transformation-type class=anchor aria-hidden=true>#</a></h3><pre><code class=language-go>type Transformation = func(input string, tools *Tools) string
</code></pre><h3 id=example>Example<a href=#example class=anchor aria-hidden=true>#</a></h3><pre><code class=language-go>import (
  &quot;github.com/jptosso/coraza-waf/transformations&quot;
  &quot;github.com/jptosso/coraza-waf/plugins&quot;
  &quot;strings&quot;
)

func transformationToLowercase(input string, _ *transformations.Tools) string {
	return strings.ToLower(input)
}

func init() {
  plugins.RegisterTransformation(&quot;tolower2&quot;, transformationToLowercase)
}
</code></pre><h2 id=creating-rule-operators>Creating Rule Operators<a href=#creating-rule-operators class=anchor aria-hidden=true>#</a></h2><h3 id=rule-operator-interface>Rule Operator interface<a href=#rule-operator-interface class=anchor aria-hidden=true>#</a></h3><pre><code class=language-go>// Operator interface is used to define rule @operators
type Operator interface {
	// Init is used during compilation to setup and cache
	// the operator
	Init(string) error
	// Evaluate is used during the rule evaluation,
	// it returns true if the operator succeeded against
	// the input data for the transaction
	Evaluate(*Transaction, string) bool
}
</code></pre><h3 id=creating-a-custom-operator>Creating a custom operator<a href=#creating-a-custom-operator class=anchor aria-hidden=true>#</a></h3><pre><code class=language-go>type opEven struct{}

func (opEven) Init(_ string) error {
	return nil
}

func (opEven) Evaluate(_ *coraza.Transaction, input string) bool {
	i, _ := strconv.Atoi(input)
	return i%2 == 0
}

//Tripwire
var _ coraza.Operator = &amp;opEven{}
</code></pre><h3 id=transforming-the-operator-to-plugin>Transforming the operator to plugin<a href=#transforming-the-operator-to-plugin class=anchor aria-hidden=true>#</a></h3><p>Once the operator is created, it must be wrapper inside a <code>type PluginOperatorWrapper = func() coraza.Operator</code> in order to be registered.</p><pre><code class=language-go>import(
    &quot;github.com/jptosso/coraza-waf&quot;
    &quot;github.com/jptosso/coraza-waf/plugins&quot;
)

func init() {
	plugins.RegisterOperator(&quot;even&quot;, func() coraza.Operator {
		return &amp;opEven{}
	})
}
</code></pre><p>After properly importing the plugin, you may be able to create rules with <code>even</code> operator, for example:</p><pre><code>SecRule ARGS:id &quot;@even&quot; &quot;id:1, nolog, pass&quot;
</code></pre><h2 id=testing-your-plugin>Testing your plugin<a href=#testing-your-plugin class=anchor aria-hidden=true>#</a></h2><p>There are no special helpers to test plugins but you may use the seclang compiler to achieve this, for example, if we want to test that the tolower2 transformation works we must write the following test:</p><pre><code class=language-go>import(
  &quot;github.com/jptosso/coraza-waf/seclang&quot;
  &quot;github.com/jptosso/coraza-waf&quot;
  &quot;strings&quot;
  &quot;testing&quot;
)

func TestToLower2(t *testing.T){
  waf := coraza.NewWaf()
  parser := seclang.NewParser(waf)
  if err := parser.FromString(`SecRule ARGS:id &quot;lowercase&quot; &quot;id:1, t:tolower2&quot;`); err != nil{
    t.Error(err)
  }
  str := &quot;TOLowEr&quot;
  if strings.ToLower(str) != transformationToLowercase(TOLowEr) {
    t.Error(&quot;Transformation tolower2 failed&quot;)
  }
}
</code></pre><h2 id=adding-plugins-to-coraza-plugin-repository>Adding plugins to Coraza Plugin Repository<a href=#adding-plugins-to-coraza-plugin-repository class=anchor aria-hidden=true>#</a></h2><p>This feature will be available soon, in the meantime, you can edit this site and add plugins to <code>plugins.html</code>.</p><p>The site will update it&rsquo;s database every 60 minutes, searching for projects with the <code>coraza-plugin</code> topic.</p><p>If the site fails to add the plugin to the database, it will create an issue with the details.</p><h3 id=requirements>Requirements<a href=#requirements class=anchor aria-hidden=true>#</a></h3><ul><li>The project must be public in github.</li><li>The project must have the <code>coraza-plugin</code> keyword.</li><li>The project must have a valid <code>.coraza.yml</code> file in the root path.</li><li>The project must have a valid <code>go.mod</code> file</li></ul><h3 id=corazayml>.coraza.yml<a href=#corazayml class=anchor aria-hidden=true>#</a></h3><p>This file will be used in the future by the Coraza Public Plugin Repository, it&rsquo;s not required by the plugin itself.</p><p><code>.coraza.yml</code> must be placed in the root directory of your repository and it must contain the following valid yaml structure:</p><pre><code class=language-yaml># We only accept alphanumeric and -.  ([\w-])
name: some-plugin
author: Your Full name or whatever you want to show
repository: github.com/path/to-project
# Coraza Plugin repository will only accept projects with apache2, MIT and BSD licenses,
# we might accept more in the future
license: apache2
description: Short description to display in plugins.coraza.io
# We are using Ruby Gem version syntax: https://guides.rubygems.org/patterns/#pessimistic-version-constraint
# The min supported Coraza version, each item represents an AND operator
version: 
  - &quot;&gt;= v1.1&quot;
  - &quot;&lt; v2&quot;
  # or ~&gt; that is identical to the previous statements
  - &quot;~&gt; v1.1&quot;
tags:
  - Add some tags
  - For filtering
declarations:
  - name: even
    type: operator|operator|transformation
    description: Will match if the number is even
</code></pre><p class=edit-page><a href=https://github.com/jptosso/coraza.io/blob/master/content/docs/reference/extending.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></p><div class="docs-navigation d-flex justify-content-between"><a href=https://coraza.io/docs/tutorials/devsecops/><div class="card my-1"><div class="card-body py-2">&larr; Continuous Delivery</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by a lot of love ❤️ (and code) - By Juan Pablo Tosso</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://coraza.io/js/bootstrap.min.586171fec3966d1a44fa8aa2edb24b861dc3a72be8cc24aa4e0dabe4c312a0dae5fe1eaa7c93180a6211fa4d7c5461b0d228fdf741be2eae279a376dfa1e7d81.js integrity="sha512-WGFx/sOWbRpE+oqi7bJLhh3DpyvozCSqTg2r5MMSoNrl/h6qfJMYCmIR+k18VGGw0ij990G+Lq4nmjdt+h59gQ==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/js/highlight.min.1ab3e69e3c90b676a93a18bc0bf4646027247fa962dcea5d1924977e2945ce7cf6ecb517aa83d226761fa79081cdb08ed74cb20cfc40a0b0ffba9e9192c56378.js integrity="sha512-GrPmnjyQtnapOhi8C/RkYCckf6li3OpdGSSXfilFznz27LUXqoPSJnYfp5CBzbCO10yyDPxAoLD/up6RksVjeA==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/main.min.9e62c9b0c5dc8279689cc9cb693a32c8ea1d19032f574f98c782ff59a0417d3662ff94b1a7755ab72a7a1862644bf00a58492c65aa0adabbc58080f4018c61bc.js integrity="sha512-nmLJsMXcgnlonMnLaToyyOodGQMvV0+Yx4L/WaBBfTZi/5Sxp3Vatyp6GGJkS/AKWEksZaoK2rvFgID0AYxhvA==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/index.min.978d63ef1debe78539588833a7595a5ef25ca56fb89c09422738811f87e6636330a7d9bef4dd790e4e02f10b93b73a96f6eb12690c3da561deccb1d7ad27ed50.js integrity="sha512-l41j7x3r54U5WIgzp1laXvJcpW+4nAlCJziBH4fmY2Mwp9m+9N15Dk4C8QuTtzqW9usSaQw9pWHezLHXrSftUA==" crossorigin=anonymous defer></script></body></html>